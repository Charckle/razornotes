{% extends "memory_module/base.html" %}

{% block extraheader %}
{% endblock %}

{% block content%}

  <main>
  <br>
  
  <nav aria-label="breadcrumb">
    <ol class="breadcrumb">
      <li class="breadcrumb-item"><a href="{{ url_for('memory_module.index') }}">Home</a></li>
      <li class="breadcrumb-item active" aria-current="page">Email Settings</li>
    </ol>
  </nav>
  
  <div class="row g-5">
    <div class="col-md-12">
      <div class="py-4 text-center">
        <h2>Email Settings</h2>
        <p class="text-muted">Configure email server for memory game reminders</p>
      </div>
    </div>
  </div>
  
  <div class="row mb-4">
    <div class="col-md-8 offset-md-2">
      <div class="card">
        <div class="card-header">
          <h5 class="card-title mb-0">Current Configuration</h5>
        </div>
        <div class="card-body">
          <table class="table table-bordered">
            <tr>
              <th width="30%">SMTP Host:</th>
              <td>{{ config.smtp_host or 'Not set' }}</td>
            </tr>
            <tr>
              <th>SMTP Port:</th>
              <td>{{ config.smtp_port or 'Not set' }}</td>
            </tr>
            <tr>
              <th>SMTP User:</th>
              <td>{{ config.smtp_user or 'Not set' }}</td>
            </tr>
            <tr>
              <th>From Address:</th>
              <td>{{ config.from_address or 'Not set' }}</td>
            </tr>
            <tr>
              <th>From Name:</th>
              <td>{{ config.app_name }}</td>
            </tr>
            <tr>
              <th>Password:</th>
              <td>
                {% if config.password_set %}
                  <span class="badge bg-success">Set</span>
                {% else %}
                  <span class="badge bg-danger">Not set</span>
                {% endif %}
              </td>
            </tr>
          </table>
          
          <div class="alert alert-info mt-3">
            <strong>Note:</strong> Email settings are configured via environment variables:
            <ul class="mb-0 mt-2">
              <li><code>WEBSITE_URL</code> - Base URL of the website (e.g., https://example.com)</li>
              <li><code>EMAIL_SMTP_HOST</code> - SMTP server hostname</li>
              <li><code>EMAIL_SMTP_PORT</code> - SMTP server port (default: 465)</li>
              <li><code>EMAIL_SMTP_USER</code> - SMTP username</li>
              <li><code>EMAIL_SMTP_PASSWORD</code> - SMTP password</li>
              <li><code>EMAIL_FROM_ADDRESS</code> - Sender email address</li>
            </ul>
          </div>
          
          <form method="POST" action="{{ url_for('memory_module.email_settings') }}">
            <button type="submit" name="test_email" class="btn btn-primary">
              Test Email Connection
            </button>
            <button type="submit" name="send_test_email" class="btn btn-success">
              Send Test Reminder Email
            </button>
            <a href="{{ url_for('memory_module.index') }}" class="btn btn-secondary">Back</a>
          </form>
          {% if config.user_email %}
            <div class="alert alert-info mt-3 mb-0">
              <small><strong>Test email will be sent to:</strong> {{ config.user_email }}</small>
            </div>
          {% else %}
            <div class="alert alert-warning mt-3 mb-0">
              <small><strong>Note:</strong> Your account does not have an email address configured.</small>
            </div>
          {% endif %}
        </div>
      </div>
    </div>
  </div>
  
  </main>
{% endblock %}

